":"; exec ./ebatch --no-site-file -l $0
(require 'database)
(edb-interact (expand-file-name "examples/null.edb" (getenv "topsrcdir")) nil)
(defun vov () (edb--1D dbc-database :vov))
(defun count () (database-no-of-records dbc-database))
(let ((vsz (length (vov)))
      (n (count)))
  (unless (<= vsz n)
    (db-copy-record (- vsz n))
    (setq n (count)))
  (message "before[%d]:" (count)) (pp (vov))
  (db-delete-record t)
  (message "after[%d]:" (count)) (pp (vov))
  (unless (= (1- n) (count))
    (error "ERROR: delete failed"))
  (when (aref (vov) (count))
    (error "ERROR: unclean shift (highest non-nil)")))
